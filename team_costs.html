<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang-en="Team and Costs" data-lang-ar="تكاليف الفريق">Team and Costs</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Poppins', sans-serif;
        direction: ltr;
      }
      body.ar {
        font-family: 'Tajawal', sans-serif;
        direction: rtl;
      }
      .slide-container {
        width: 1280px;
        min-height: 720px;
        background: #FFFFFF;
        margin: 0 auto;
        overflow: hidden;
        position: relative;
      }
      h1 {
        color: #1E88E5;
        font-size: 72px;
        font-weight: 700;
      }
      h2 {
        color: #1E88E5;
        font-size: 36px;
        font-weight: 500;
      }
      p, li {
        color: #212121;
        font-size: 24px;
        font-weight: 400;
      }
      .highlight {
        color: #4CAF50;
        font-weight: 500;
      }
      .logo {
        width: 120px;
        height: auto;
        margin-bottom: 20px;
      }
      .team-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        padding: 20px;
        margin: 10px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s ease;
      }
      .team-card:hover {
        transform: translateY(-5px);
      }
      .cost-breakdown {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        border-radius: 15px;
        padding: 20px;
        margin: 10px 0;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      }
      .salary-input {
        width: 120px;
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        text-align: center;
        font-size: 16px;
        margin: 5px;
      }
      .name-input {
        background: transparent;
        border: none;
        color: white;
        font-size: 16px;
        border-bottom: 1px solid rgba(255,255,255,0.3);
        padding: 2px 5px;
        margin: 0 5px;
        min-width: 200px;
      }
      .name-input:focus {
        outline: none;
        border-bottom: 1px solid white;
      }
      .btn {
        padding: 10px 20px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        border: none;
        transition: all 0.3s ease;
      }
      .btn-primary {
        background: linear-gradient(135deg, #1E88E5 0%, #42A5F5 100%);
        color: white;
      }
      .btn-primary:hover {
        background: linear-gradient(135deg, #1565C0 0%, #1E88E5 100%);
        transform: translateY(-2px);
      }
      .btn-success {
        background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        color: white;
      }
      .btn-danger {
        background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
        color: white;
        padding: 5px 10px;
        font-size: 12px;
      }
      .chart-container {
        position: relative;
        height: 300px;
        margin: 20px 0;
        background: white;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .total-cost {
        background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        color: white;
        border-radius: 15px;
        padding: 20px;
        text-align: center;
        margin: 20px 0;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      }
      .phase-timeline {
        background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
        color: white;
        border-radius: 15px;
        padding: 20px;
        margin: 10px 0;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      }
      .team-member {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }
      .team-member:last-child {
        border-bottom: none;
      }
      .editable-phase {
        background: transparent;
        border: none;
        color: white;
        font-weight: bold;
        border-bottom: 1px solid rgba(255,255,255,0.3);
        padding: 2px 5px;
        margin: 0 5px;
      }
      .editable-phase:focus {
        outline: none;
        border-bottom: 1px solid white;
      }
    </style>
  </head>
  <body>
    <div class="slide-container flex flex-col p-6">
      <div class="flex items-center mb-4">
        <img src="images/cordr_logo.png" alt="CORDR Logo" class="logo">
        <div class="ml-4">
          <h1 class="mb-0" data-lang-en="Team Structure & Costs" data-lang-ar="هيكل الفريق والتكاليف">Team Structure & Costs</h1>
          <p class="text-lg text-gray-600" data-lang-en="Building the Right Team for Success" data-lang-ar="بناء الفريق المناسب للنجاح">Building the Right Team for Success</p>
        </div>
      </div>
      
      <div class="flex justify-between">
        <div class="w-1/2 pr-4">
          <div class="phase-timeline">
            <h3 class="text-xl font-bold mb-4">
              <i class="fas fa-calendar-alt mr-2"></i><span data-lang-en="Development Phases" data-lang-ar="مراحل التطوير">Development Phases</span>
            </h3>
            <div class="space-y-3" id="phasesList">
              <div class="flex justify-between phase-item">
                <span><strong><input type="text" class="editable-phase" value="Phase 1 (Months 1-6)" data-lang-ar="المرحلة 1 (الأشهر 1-6)">:</strong> <input type="text" class="editable-phase" value="MVP Development" data-lang-ar="تطوير النموذج الأولي"></span>
                <span class="font-bold">$480K</span>
                <button class="btn-danger" onclick="removePhase(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
              <div class="flex justify-between phase-item">
                <span><strong><input type="text" class="editable-phase" value="Phase 2 (Months 7-12)" data-lang-ar="المرحلة 2 (الأشهر 7-12)">:</strong> <input type="text" class="editable-phase" value="Market Launch" data-lang-ar="إطلاق السوق"></span>
                <span class="font-bold">$720K</span>
                <button class="btn-danger" onclick="removePhase(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
              <div class="flex justify-between phase-item">
                <span><strong><input type="text" class="editable-phase" value="Phase 3 (Year 2)" data-lang-ar="المرحلة 3 (السنة 2)">:</strong> <input type="text" class="editable-phase" value="Scale & Expansion" data-lang-ar="التوسع والنمو"></span>
                <span class="font-bold">$1.2M</span>
                <button class="btn-danger" onclick="removePhase(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
            </div>
            <button class="btn btn-success mt-3" onclick="addPhase()" data-lang-en="Add Phase" data-lang-ar="إضافة مرحلة">
              <i class="fas fa-plus mr-2"></i>Add Phase
            </button>
          </div>
          
          <div class="team-card">
            <h3 class="text-xl font-bold mb-4">
              <i class="fas fa-users mr-2"></i><span data-lang-en="Core Team Structure" data-lang-ar="هيكل الفريق الأساسي">Core Team Structure</span>
            </h3>
            <div class="space-y-2" id="teamMembersList">
              <div class="team-member">
                <span><i class="fas fa-user-tie mr-2"></i><input type="text" class="name-input" value="CEO/Founder" data-lang-ar="الرئيس التنفيذي/المؤسس"></span>
                <input type="number" class="salary-input" value="120" min="0" step="5">
                <span data-lang-en="K/year" data-lang-ar="ألف/سنة">K/year</span>
                <button class="btn-danger" onclick="removeTeamMember(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
              <div class="team-member">
                <span><i class="fas fa-code mr-2"></i><input type="text" class="name-input" value="CTO/Lead Developer" data-lang-ar="مدير التقنية/المطور الرئيسي"></span>
                <input type="number" class="salary-input" value="100" min="0" step="5">
                <span data-lang-en="K/year" data-lang-ar="ألف/سنة">K/year</span>
                <button class="btn-danger" onclick="removeTeamMember(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
              <div class="team-member">
                <span><i class="fas fa-mobile-alt mr-2"></i><input type="text" class="name-input" value="Mobile Developers (2)" data-lang-ar="مطوري التطبيقات (2)"></span>
                <input type="number" class="salary-input" value="160" min="0" step="5">
                <span data-lang-en="K/year" data-lang-ar="ألف/سنة">K/year</span>
                <button class="btn-danger" onclick="removeTeamMember(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
              <div class="team-member">
                <span><i class="fas fa-server mr-2"></i><input type="text" class="name-input" value="Backend Developers (2)" data-lang-ar="مطوري الخادم (2)"></span>
                <input type="number" class="salary-input" value="140" min="0" step="5">
                <span data-lang-en="K/year" data-lang-ar="ألف/سنة">K/year</span>
                <button class="btn-danger" onclick="removeTeamMember(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
              <div class="team-member">
                <span><i class="fas fa-paint-brush mr-2"></i><input type="text" class="name-input" value="UI/UX Designer" data-lang-ar="مصمم واجهات المستخدم"></span>
                <input type="number" class="salary-input" value="70" min="0" step="5">
                <span data-lang-en="K/year" data-lang-ar="ألف/سنة">K/year</span>
                <button class="btn-danger" onclick="removeTeamMember(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
              <div class="team-member">
                <span><i class="fas fa-chart-line mr-2"></i><input type="text" class="name-input" value="Marketing Manager" data-lang-ar="مدير التسويق"></span>
                <input type="number" class="salary-input" value="80" min="0" step="5">
                <span data-lang-en="K/year" data-lang-ar="ألف/سنة">K/year</span>
                <button class="btn-danger" onclick="removeTeamMember(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
              <div class="team-member">
                <span><i class="fas fa-headset mr-2"></i><input type="text" class="name-input" value="Customer Support (2)" data-lang-ar="دعم العملاء (2)"></span>
                <input type="number" class="salary-input" value="90" min="0" step="5">
                <span data-lang-en="K/year" data-lang-ar="ألف/سنة">K/year</span>
                <button class="btn-danger" onclick="removeTeamMember(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              </div>
            </div>
            <button class="btn btn-success mt-3" onclick="addTeamMember()" data-lang-en="Add Team Member" data-lang-ar="إضافة عضو فريق">
              <i class="fas fa-plus mr-2"></i>Add Team Member
            </button>
            <button class="mt-4 btn btn-primary w-full" onclick="calculateTeamCosts()">
              <i class="fas fa-calculator mr-2"></i><span data-lang-en="Calculate Total Costs" data-lang-ar="حساب إجمالي التكاليف">Calculate Total Costs</span>
            </button>
          </div>
          
          <div class="total-cost">
            <h3 class="text-2xl font-bold mb-2">
              <i class="fas fa-dollar-sign mr-2"></i><span data-lang-en="Annual Team Cost" data-lang-ar="تكلفة الفريق السنوية">Annual Team Cost</span>
            </h3>
            <div class="text-4xl font-bold" id="totalTeamCost">$760K</div>
            <div class="text-sm mt-2" data-lang-en="Including benefits and overhead (30%)" data-lang-ar="شاملة المزايا والنفقات الإضافية (30%)">Including benefits and overhead (30%)</div>
          </div>
        </div>
        
        <div class="w-1/2 pl-4">
          <div class="cost-breakdown">
            <h3 class="text-xl font-bold mb-4">
              <i class="fas fa-pie-chart mr-2"></i><span data-lang-en="Cost Breakdown Analysis" data-lang-ar="تحليل تفصيل التكاليف">Cost Breakdown Analysis</span>
            </h3>
            <div class="grid grid-cols-2 gap-4">
              <div class="text-center">
                <div class="text-3xl font-bold" id="developmentPercent">65%</div>
                <div class="text-sm" data-lang-en="Development Team" data-lang-ar="فريق التطوير">Development Team</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold" id="managementPercent">20%</div>
                <div class="text-sm" data-lang-en="Management" data-lang-ar="الإدارة">Management</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold" id="marketingPercent">10%</div>
                <div class="text-sm" data-lang-en="Marketing" data-lang-ar="التسويق">Marketing</div>
              </div>
              <div class="text-center">
                <div class="text-3xl font-bold" id="supportPercent">5%</div>
                <div class="text-sm" data-lang-en="Support" data-lang-ar="الدعم">Support</div>
              </div>
            </div>
          </div>
          
          <div class="chart-container">
            <canvas id="teamCostChart"></canvas>
          </div>
          
          <div class="chart-container">
            <canvas id="hiringTimelineChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    
    <script src="js/language.js"></script>
    <script>
      let teamCostChart;
      let hiringTimelineChart;

      function addTeamMember() {
        const teamMembersList = document.getElementById('teamMembersList');
        const newMember = document.createElement('div');
        newMember.className = 'team-member';
        newMember.innerHTML = `
          <span><i class="fas fa-user mr-2"></i><input type="text" class="name-input" value="New Team Member" data-lang-ar="عضو فريق جديد"></span>
          <input type="number" class="salary-input" value="60" min="0" step="5">
          <span data-lang-en="K/year" data-lang-ar="ألف/سنة">K/year</span>
          <button class="btn-danger" onclick="removeTeamMember(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
        `;
        teamMembersList.appendChild(newMember);
        
        // Add event listener for the new salary input
        const newSalaryInput = newMember.querySelector('.salary-input');
        newSalaryInput.addEventListener('change', calculateTeamCosts);
        
        calculateTeamCosts();
        updateLanguageDisplay();
      }

      function removeTeamMember(button) {
        button.parentElement.remove();
        calculateTeamCosts();
      }

      function addPhase() {
        const phasesList = document.getElementById('phasesList');
        const newPhase = document.createElement('div');
        newPhase.className = 'flex justify-between phase-item';
        newPhase.innerHTML = `
          <span><strong><input type="text" class="editable-phase" value="New Phase" data-lang-ar="مرحلة جديدة">:</strong> <input type="text" class="editable-phase" value="Description" data-lang-ar="الوصف"></span>
          <span class="font-bold">$100K</span>
          <button class="btn-danger" onclick="removePhase(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
        `;
        phasesList.appendChild(newPhase);
        updateLanguageDisplay();
      }

      function removePhase(button) {
        button.parentElement.remove();
      }

      function calculateTeamCosts() {
        const salaryInputs = document.querySelectorAll('#teamMembersList .salary-input');
        let totalBaseCost = 0;
        
        salaryInputs.forEach(input => {
          totalBaseCost += parseFloat(input.value) || 0;
        });
        
        const totalCost = totalBaseCost * 1.3; // Including 30% overhead
        
        // Update display based on current currency
        const currentCurrency = localStorage.getItem('currency') || 'USD';
        if (currentCurrency === 'SAR') {
          const sarAmount = totalCost * 3.75; // Convert to SAR
          document.getElementById('totalTeamCost').textContent = (sarAmount / 1000).toFixed(2) + ' مليون ريال';
        } else {
          document.getElementById('totalTeamCost').textContent = '$' + totalCost.toFixed(0) + 'K';
        }
        
        // Calculate percentages (simplified categorization)
        const teamMembers = document.querySelectorAll('#teamMembersList .team-member');
        let developmentCost = 0;
        let managementCost = 0;
        let marketingCost = 0;
        let supportCost = 0;
        
        teamMembers.forEach(member => {
          const name = member.querySelector('.name-input').value.toLowerCase();
          const salary = parseFloat(member.querySelector('.salary-input').value) || 0;
          
          if (name.includes('developer') || name.includes('مطور')) {
            developmentCost += salary;
          } else if (name.includes('ceo') || name.includes('cto') || name.includes('رئيس') || name.includes('مدير التقنية')) {
            managementCost += salary;
          } else if (name.includes('marketing') || name.includes('تسويق')) {
            marketingCost += salary;
          } else {
            supportCost += salary;
          }
        });
        
        if (totalBaseCost > 0) {
          document.getElementById('developmentPercent').textContent = Math.round((developmentCost / totalBaseCost) * 100) + '%';
          document.getElementById('managementPercent').textContent = Math.round((managementCost / totalBaseCost) * 100) + '%';
          document.getElementById('marketingPercent').textContent = Math.round((marketingCost / totalBaseCost) * 100) + '%';
          document.getElementById('supportPercent').textContent = Math.round((supportCost / totalBaseCost) * 100) + '%';
        }
        
        updateTeamCostChart();
        saveTeamData();
      }

      function createTeamCostChart() {
        const ctx = document.getElementById('teamCostChart').getContext('2d');
        
        const teamMembers = document.querySelectorAll('#teamMembersList .team-member');
        const labels = [];
        const data = [];
        const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF'];
        
        teamMembers.forEach((member, index) => {
          const name = member.querySelector('.name-input').value;
          const salary = parseFloat(member.querySelector('.salary-input').value) || 0;
          labels.push(name.length > 15 ? name.substring(0, 15) + '...' : name);
          data.push(salary);
        });

        const chartData = {
          labels: labels,
          datasets: [{
            label: currentLang === 'ar' ? 'الراتب السنوي (ألف)' : 'Annual Salary (K)',
            data: data,
            backgroundColor: colors.slice(0, data.length),
            borderColor: colors.slice(0, data.length),
            borderWidth: 2
          }]
        };

        const chartOptions = {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: currentLang === 'ar' ? 'توزيع رواتب الفريق' : 'Team Salary Distribution',
              font: {
                size: 16,
                weight: 'bold'
              }
            },
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: currentLang === 'ar' ? 'الراتب (ألف)' : 'Salary (K)',
                font: {
                  size: 12
                }
              }
            }
          }
        };

        if (teamCostChart) teamCostChart.destroy();
        teamCostChart = new Chart(ctx, { type: 'bar', data: chartData, options: chartOptions });
      }

      function createHiringTimelineChart() {
        const ctx = document.getElementById('hiringTimelineChart').getContext('2d');

        const chartData = {
          labels: currentLang === 'ar' ? 
            ['الشهر 1', 'الشهر 3', 'الشهر 6', 'الشهر 9', 'الشهر 12', 'الشهر 18'] :
            ['Month 1', 'Month 3', 'Month 6', 'Month 9', 'Month 12', 'Month 18'],
          datasets: [{
            label: currentLang === 'ar' ? 'عدد الموظفين' : 'Team Size',
            data: [3, 5, 7, 9, 11, 15],
            backgroundColor: 'rgba(30, 136, 229, 0.2)',
            borderColor: 'rgba(30, 136, 229, 1)',
            borderWidth: 3,
            fill: true,
            tension: 0.4
          }]
        };

        const chartOptions = {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            title: {
              display: true,
              text: currentLang === 'ar' ? 'جدول التوظيف الزمني' : 'Hiring Timeline',
              font: {
                size: 16,
                weight: 'bold'
              }
            },
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: currentLang === 'ar' ? 'عدد الموظفين' : 'Number of Employees',
                font: {
                  size: 12
                }
              }
            }
          }
        };

        if (hiringTimelineChart) hiringTimelineChart.destroy();
        hiringTimelineChart = new Chart(ctx, { type: 'line', data: chartData, options: chartOptions });
      }

      function updateTeamCostChart() {
        createTeamCostChart();
      }

      function saveTeamData() {
        const teamMembers = [];
        const phases = [];
        
        document.querySelectorAll('#teamMembersList .team-member').forEach(member => {
          const name = member.querySelector('.name-input').value;
          const salary = member.querySelector('.salary-input').value;
          teamMembers.push({ name, salary });
        });
        
        document.querySelectorAll('#phasesList .phase-item').forEach(phase => {
          const inputs = phase.querySelectorAll('.editable-phase');
          const phaseName = inputs[0].value;
          const description = inputs[1].value;
          phases.push({ phaseName, description });
        });
        
        const teamData = { teamMembers, phases };
        localStorage.setItem('cordrTeamData', JSON.stringify(teamData));
      }

      function loadTeamData() {
        const savedData = localStorage.getItem('cordrTeamData');
        if (savedData) {
          const teamData = JSON.parse(savedData);
          
          // Load team members
          if (teamData.teamMembers) {
            const teamMembersList = document.getElementById('teamMembersList');
            teamMembersList.innerHTML = '';
            
            teamData.teamMembers.forEach(member => {
              const memberDiv = document.createElement('div');
              memberDiv.className = 'team-member';
              memberDiv.innerHTML = `
                <span><i class="fas fa-user mr-2"></i><input type="text" class="name-input" value="${member.name}"></span>
                <input type="number" class="salary-input" value="${member.salary}" min="0" step="5">
                <span data-lang-en="K/year" data-lang-ar="ألف/سنة">K/year</span>
                <button class="btn-danger" onclick="removeTeamMember(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              `;
              teamMembersList.appendChild(memberDiv);
              
              // Add event listener
              const salaryInput = memberDiv.querySelector('.salary-input');
              salaryInput.addEventListener('change', calculateTeamCosts);
            });
          }
          
          // Load phases
          if (teamData.phases) {
            const phasesList = document.getElementById('phasesList');
            phasesList.innerHTML = '';
            
            teamData.phases.forEach(phase => {
              const phaseDiv = document.createElement('div');
              phaseDiv.className = 'flex justify-between phase-item';
              phaseDiv.innerHTML = `
                <span><strong><input type="text" class="editable-phase" value="${phase.phaseName}">:</strong> <input type="text" class="editable-phase" value="${phase.description}"></span>
                <span class="font-bold">$100K</span>
                <button class="btn-danger" onclick="removePhase(this)" data-lang-en="Remove" data-lang-ar="إزالة">×</button>
              `;
              phasesList.appendChild(phaseDiv);
            });
          }
        }
      }

      // Function to update page content when language changes
      window.updatePageContent = function(lang) {
        createTeamCostChart();
        createHiringTimelineChart();
        calculateTeamCosts();
      };

      document.addEventListener("DOMContentLoaded", () => {
        loadTeamData();
        calculateTeamCosts();
        createTeamCostChart();
        createHiringTimelineChart();

        // Add event listeners for existing salary inputs
        document.querySelectorAll('.salary-input').forEach(input => {
          input.addEventListener('change', calculateTeamCosts);
        });
      });
    </script>
  </body>
</html>

